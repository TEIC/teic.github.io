<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="/css/tei.css"><script type="text/javascript" src="/js/CETEI.js"></script></head><body>
<tei-tei data-xmlns="http://www.tei-c.org/ns/1.0" data-origname="TEI">
    <tei-teiheader data-origname="teiHeader">
        <tei-filedesc data-origname="fileDesc">
            <tei-titlestmt data-origname="titleStmt">
                <tei-title data-origname="title">The Roma install on tei-c.org</tei-title>
                <tei-author data-origname="author">Martin Holmes</tei-author>
            </tei-titlestmt>
            <tei-editionstmt data-origname="editionStmt">
                <tei-edition data-origname="edition">
                    <tei-date data-origname="date">2015-12-29</tei-date>
                </tei-edition>
            </tei-editionstmt>
            <tei-publicationstmt data-origname="publicationStmt">
                <tei-p data-origname="p">freely available</tei-p>
            </tei-publicationstmt>
            <tei-sourcedesc data-origname="sourceDesc">
                <tei-p data-origname="p">Born-digital document</tei-p>
            </tei-sourcedesc>
        </tei-filedesc>
    </tei-teiheader>
    
    <tei-text data-origname="text">
        <tei-front data-origname="front">
            <tei-div data-origname="div">
                <tei-p data-origname="p">During the fall of 2015, Martin Holmes and Ian Rifkin worked on deploying a new version 
                of Roma with a minor bugfix on tei-c.org, and formalized a previously rather ad-hoc setup
                so that future bugfixes and updates might be less mysterious. This document explains how the 
                current setup works, and how to deploy an updated version of Roma.</tei-p>
            </tei-div>
        </tei-front>
        <tei-body data-origname="body">
            <tei-div data-origname="div">
                <tei-head data-origname="head">Where is Roma on tei-c.org?</tei-head>
                
                <tei-p data-origname="p">Roma, a helpful but rather outdated front end which enables people to create customized 
                ODD files and schemas in a GUI interface, is available for public use here:
                <tei-list data-origname="list">
                    <tei-item data-origname="item"><tei-ref data-origname="ref" data-origatts="target" target="http://www.tei-c.org/Roma/">http://www.tei-c.org/Roma/</tei-ref></tei-item>
                </tei-list>
            If you click on "Start" to enter the process, you will see that the footer of the page shows 
            detailed information about the current Roma version as well as the version of P5 it is using.
            </tei-p>
            
            <tei-p data-origname="p">If you have permission to log into the tei-c server, you will find it quite difficult to 
            locate the actual running versions of Roma; they are (for largely historical reasons) located in
            <tei-list data-origname="list">
                <tei-item data-origname="item"><tei-code data-origname="code">/var/www/vhosts/tei-c.org/opencms_tomcat/usr/share</tei-code></tei-item>
            </tei-list>
            
            In that directory, you will find multiple versions of the Roma codebase, in folders named for their
            versions:
            
            <tei-list data-origname="list">
                <tei-item data-origname="item"><tei-code data-origname="code">tei-roma-4.15</tei-code></tei-item>
                <tei-item data-origname="item"><tei-code data-origname="code">tei-roma-4.18</tei-code></tei-item>
            </tei-list>
                
                Each of these versions is working and available on a special URL based on its version number:
                
                <tei-list data-origname="list">
                    <tei-item data-origname="item"><tei-code data-origname="code">http://www.tei-c.org/Roma-4.15/</tei-code></tei-item>
                    <tei-item data-origname="item"><tei-code data-origname="code">http://www.tei-c.org/Roma-4.18/</tei-code></tei-item>
                </tei-list>
                
                In addition, there is a symbolic link, which at the time of writing points thus:
                
                <tei-list data-origname="list">
                    <tei-item data-origname="item"><tei-code data-origname="code">tei-roma -&gt; tei-roma-4.18</tei-code></tei-item>
                </tei-list>
                
                This means that the current "live" version is 4.18.
            </tei-p>
            </tei-div>
            
            <tei-div data-origname="div">
                <tei-head data-origname="head">How to deploy a new version</tei-head>
                
                <tei-p data-origname="p">Although Roma is not currently in active development, from time to time, bugfixes may be 
                made and new versions deployed. This is how to do that:</tei-p>
                
                <tei-list data-origname="list">
                    <tei-item data-origname="item">Fix bugs on the <tei-ref data-origname="ref" data-origatts="target" target="https://github.com/TEIC/Roma">GitHub repository</tei-ref>.</tei-item>
                    <tei-item data-origname="item">Check out a fresh version from the GitHub repo into a folder in the deployment location,
                    naming the folder based on the version number of the new version:
                        <tei-list data-origname="list">
                            <tei-item data-origname="item"><tei-code data-origname="code">/var/www/vhosts/tei-c.org/opencms_tomcat/usr/share/tei-roma-4.20</tei-code></tei-item>
                        </tei-list>
                    </tei-item>
                    <tei-item data-origname="item">Test the new version thoroughly using its version-based URL:
                        <tei-list data-origname="list">
                            <tei-item data-origname="item"><tei-code data-origname="code">http://www.tei-c.org/Roma-4.20/</tei-code></tei-item>
                        </tei-list>
                        which will be available automatically through the Apache configuration.
                    </tei-item>
                    <tei-item data-origname="item">When you are confident that it's working correctly, ask the server administrator 
                    (currently Ian Rifkin) to update the symbolic link so that it becomes the current live
                    version. (You may be able to do this yourself.)</tei-item>
                </tei-list>
            </tei-div>
            
            <tei-div data-origname="div">
                <tei-head data-origname="head">Configuration of Roma to run on tei-c.org</tei-head>
                
                <tei-p data-origname="p">The configuration of Roma is controlled by a number of files:
                <tei-list data-origname="list">
                    <tei-item data-origname="item"><tei-code data-origname="code">VERSION</tei-code>, which contains the Roma version number. When doing a bugfix, don't forget 
                    to update this file.</tei-item>
                    <tei-item data-origname="item"><tei-code data-origname="code">roma/config.php</tei-code>, which has all the URLs pointing to OxGarage and the eXist XML database
                    required for Roma to function, as well as some local paths. It is recommended that you copy the config.php
                    from the previous live version of Roma into a new deployment, and then just make a couple of required 
                    tweaks (such as changing the release date and the version number).</tei-item>
                    <tei-item data-origname="item"><tei-code data-origname="code">roma/templates/main.tem</tei-code>. Due to <tei-ref data-origname="ref" data-origatts="target" target="https://github.com/TEIC/Roma/issues/10">a bug</tei-ref>, 
                        this file must also be updated to provide the date of the roma release, in order for the correct date
                    to appear in the footer of pages.</tei-item>
                </tei-list>
                </tei-p>
            </tei-div>
            
            <tei-div data-origname="div">
                <tei-head data-origname="head">What does Roma depend on?</tei-head>
                
                <tei-p data-origname="p">
                    Roma does not do a great deal of real work itself. Instead, it requires a number of resources and services 
                    in order to work; these are apparent in the configuration file:<tei-lb data-origname="lb"></tei-lb>
                    
                <tei-code data-origname="code">
                    define ( 'roma_xquery_server',       'http://www.tei-c.org/Query/' );
                </tei-code><tei-lb data-origname="lb"></tei-lb>
                
                Roma uses the P5 Subset file retrieved via an XQuery call to the eXist XML 
                database running on tei-c.org as a source of 
                    information on the modules, classes, elements and attributes available in the current release version 
                    of P5. That's why the eXist XML database must be updated as part of a P5 release.<tei-lb data-origname="lb"></tei-lb>
                    
                    <tei-code data-origname="code">
                        define ( 'roma_teiweb_server',       'http://www.tei-c.org/release/doc/tei-p5-doc/' );
                    </tei-code><tei-lb data-origname="lb"></tei-lb>
                    
                In other operations such as adding elements and attributes to a schema, it retrieves information
                from the current live version of TEI P5 on the tei-c server.<tei-lb data-origname="lb"></tei-lb>
                    
                    <tei-code data-origname="code">
                        define ( 'oxgarage_server',          'http://www.tei-c.org/ege-webservice');
                    </tei-code><tei-lb data-origname="lb"></tei-lb>
                    
                    Finally, in order to transform an ODD file into a schema or into documentation, it calls on 
                    the web service provided by OxGarage.</tei-p>
                
                <tei-p data-origname="p">In order for Roma to function correctly, all these services have to be updated to matching 
                versions, including (in the case of OxGarage) the latest version of the Stylesheets.</tei-p>
            </tei-div>
            
        </tei-body>
    </tei-text>
</tei-tei>
<script type="text/javascript">
          var c = new CETEI();
          c.els = ["tei:TEI","tei:teiHeader","tei:fileDesc","tei:titleStmt","tei:title","tei:author","tei:editionStmt","tei:edition","tei:date","tei:publicationStmt","tei:p","tei:sourceDesc","tei:text","tei:front","tei:div","tei:body","tei:head","tei:list","tei:item","tei:ref","tei:code","tei:lb",];
          c.els.push("egXML");
          c.applyBehaviors();
        </script></body></html>
