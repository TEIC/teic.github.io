<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><!--THIS FILE IS GENERATED FROM AN XML MASTER. DO NOT EDIT (5)--><title>ANY XML and what should replace it</title><meta name="author" content="Lou Burnard" /><meta name="generator" content="Text Encoding Initiative Consortium XSLT stylesheets" /><meta name="DC.Title" content="ANY XML and what should replace it" /><meta name="DC.Type" content="Text" /><meta name="DC.Format" content="text/html" /><link href="http://www.tei-c.org/release/xml/tei/stylesheet/tei.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" media="print" type="text/css" href="http://www.tei-c.org/release/xml/tei/stylesheet/tei-print.css" /></head><body class="simple" id="TOP"><div class="stdheader autogenerated"><h2 class="institution">(unknown project)</h2><h1 class="maintitle">ANY XML and what should replace it</h1></div><!--TEI front--><h2>Table of contents</h2><ul class="toc toc_body"><li class="toc"><span class="headingNumber">1. </span><a class="toc toc_0" href="#index.xml-body.1_div.1">constraint</a></li><li class="toc"><span class="headingNumber">2. </span><a class="toc toc_0" href="#index.xml-body.1_div.2">content</a></li><li class="toc"><span class="headingNumber">3. </span><a class="toc toc_0" href="#index.xml-body.1_div.3">egXML</a></li><li class="toc"><span class="headingNumber">4. </span><a class="toc toc_0" href="#index.xml-body.1_div.4">xenoData</a></li><li class="toc"><span class="headingNumber">5. </span><a class="toc toc_0" href="#index.xml-body.1_div.5">macro.schemaPattern</a></li><li class="toc"><span class="headingNumber">6. </span><a class="toc toc_0" href="#index.xml-body.1_div.6">macro.anyXML itself</a></li><li class="toc"><span class="headingNumber">7. </span><a class="toc toc_0" href="#index.xml-body.1_div.7">Exemplars</a></li></ul><!--TEI body--><p>In an attempt to progress i<a class="link_ref" href="https://github.com/TEIC/TEI/issues/1373">issue 1173</a>, I have defined a new element <span class="gi">&lt;anyElement&gt;</span> which is intended to make a bit more transparent the currently rather obscure working of the macro <span class="ident">macro.anyXML</span>. Think of it as a little piece of pure ODD we did not finish. You can see its elementSpec <a class="link_ref" href="https://github.com/TEIC/TEI/blob/dev/P5/Source/Specs/anyElement.xml">here,</a> but of course it doesn't do anything yet since the stylesheets have yet to be modified to take any notice of it.</p><p>In the rest of this note, I will try to summarize how I plan to change elements which currently make use of macro.anyXML. There are five (or six) of them: <span class="gi">&lt;constraint&gt;</span>, <span class="gi">&lt;content&gt;</span>, <span class="gi">&lt;egXML&gt;</span>, <span class="gi">&lt;xenoData&gt;</span>, <span class="ident">macro.schemaPattern</span> and of course <span class="ident">macro.anyXML</span> itself. This macro is declared in ST, but redefined in the ODDS for tei_AllPlus, tei_math, and tei_svg, on which see further below.</p><div class="teidiv0" id="index.xml-body.1_div.1"><h2><span class="headingNumber">1. </span><span class="head"><span class="gi">&lt;constraint&gt;</span></span></h2><div class="table"><table><thead><tr class="label"><th>Current content model</th><th>Proposed content model</th></tr></thead><tbody><tr><td><div id="index.xml-egXML-d30e69" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
  <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"&gt;</span>
  <span class="element">&lt;textNode/&gt;</span>
  <span class="element">&lt;macroRef <span class="attribute">key</span>="<span class="attributevalue">macro.anyXML</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td><td><div id="index.xml-egXML-d30e77" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
  <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"&gt;</span>
  <span class="element">&lt;textNode/&gt;</span>
  <span class="element">&lt;elementRef <span class="attribute">key</span>="<span class="attributevalue">anyElement</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td></tr><tr><td colspan="2">We simply replace the macroRef here with an elementRef. We could require that constraints be expressed using the ISO Schematron namespace: <code>elementRef key="anyElement" include="http://purl.oclc.org/dsdl/schematron"</code> But that would close the door to constraints expressed in any other schema language, which might not be such a good thing (and would invalidate an existing example)</td></tr></tbody></table></div></div><div class="teidiv0" id="index.xml-body.1_div.2"><h2><span class="headingNumber">2. </span><span class="head"><span class="gi">&lt;content&gt;</span></span></h2><div class="table"><table><tr class="label"><td>Current content model</td><td>Proposed content model</td></tr><tr><td><div id="index.xml-egXML-d30e103" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate&gt;</span>
  <span class="element">&lt;macroRef <span class="attribute">key</span>="<span class="attributevalue">macro.anyXML</span>"/&gt;</span>
  <span class="element">&lt;classRef <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
   <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"
   <span class="attribute">key</span>="<span class="attributevalue">model.contentPart</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td><td><div id="index.xml-egXML-d30e111" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate&gt;</span>
  <span class="element">&lt;classRef <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
   <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"
   <span class="attribute">key</span>="<span class="attributevalue">model.contentPart</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td></tr><tr><td colspan="2">Since <span class="gi">&lt;anyElement&gt;</span> and <span class="gi">&lt;textNode&gt;</span> are already members of model.contentPart, all that is needed here is to remove the macroRef. It would be nice to be able to add the constraint that elements appearing here should come from the RelaxNG namespace, but there is no obvious way of doing this without introducing an ambiguity.</td></tr></table></div></div><div class="teidiv0" id="index.xml-body.1_div.3"><h2><span class="headingNumber">3. </span><span class="head"><span class="gi">&lt;egXML&gt;</span></span></h2><div class="table"><table><tr class="label"><td>Current content model</td><td>Proposed content model</td></tr><tr><td><div id="index.xml-egXML-d30e138" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
  <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"&gt;</span>
  <span class="element">&lt;textNode/&gt;</span>
  <span class="element">&lt;macroRef <span class="attribute">key</span>="<span class="attributevalue">macro.anyXML</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td><td><div id="index.xml-egXML-d30e146" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
  <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"&gt;</span>
  <span class="element">&lt;textNode/&gt;</span>
  <span class="element">&lt;elementRef <span class="attribute">key</span>="<span class="attributevalue">anyElement</span>"
   <span class="attribute">include</span>="<span class="attributevalue">http://www.tei-c.org/ns/Examples</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td></tr><tr><td colspan="2">We can do better here, by requiring that the content be from the egXML namespace </td></tr></table></div></div><div class="teidiv0" id="index.xml-body.1_div.4"><h2><span class="headingNumber">4. </span><span class="head"><span class="gi">&lt;xenoData&gt;</span></span></h2><div class="table"><table><tr class="label"><td>Current content model</td><td>Proposed content model</td></tr><tr><td><div id="index.xml-egXML-d30e168" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate&gt;</span>
  <span class="element">&lt;textNode/&gt;</span>
  <span class="element">&lt;macroRef <span class="attribute">key</span>="<span class="attributevalue">macro.anyXML</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td><td><div id="index.xml-egXML-d30e176" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;alternate <span class="attribute">minOccurs</span>="<span class="attributevalue">1</span>"
  <span class="attribute">maxOccurs</span>="<span class="attributevalue">unbounded</span>"&gt;</span>
  <span class="element">&lt;textNode/&gt;</span>
  <span class="element">&lt;elementRef <span class="attribute">key</span>="<span class="attributevalue">anyElement</span>"
   <span class="attribute">exccept</span>="<span class="attributevalue">http://www.tei-c.org/ns/1.0</span>"/&gt;</span>
 <span class="element">&lt;/alternate&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td></tr><tr><td colspan="2">Again, we can do better by excluding TEI namespaced elements from the content. Note that the original definition relied on repetition inherent in the macro. </td></tr></table></div></div><div class="teidiv0" id="index.xml-body.1_div.5"><h2><span class="headingNumber">5. </span><span class="head"><span class="ident">macro.schemaPattern</span></span></h2><div class="table"><table><tr class="label"><td>Current content model</td><td>Proposed content model</td></tr><tr><td><div id="index.xml-egXML-d30e198" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;macroRef <span class="attribute">key</span>="<span class="attributevalue">macro.anyXML</span>"/&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td><td><div id="index.xml-egXML-d30e204" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;elementRef <span class="attribute">key</span>="<span class="attributevalue">anyElement</span>"
  <span class="attribute">include</span>="<span class="attributevalue">http://relaxng.org/ns/structure/1.0</span>"/&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td></tr><tr><td colspan="2">This macro is used only as part of the content model for <span class="gi">&lt;datatype&gt;</span>, in order to permit continued use of relaxng data definitions. The redefinition above makes this explicit.</td></tr></table></div></div><div class="teidiv0" id="index.xml-body.1_div.6"><h2><span class="headingNumber">6. </span><span class="head"><span class="ident">macro.anyXML</span> itself</span></h2><div class="table"><table><tr class="label"><td>Current content model</td><td>Proposed content model</td></tr><tr><td><div id="index.xml-egXML-d30e228" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;rng:element&gt;</span>
  <span class="element">&lt;rng:anyName&gt;</span>
   <span class="element">&lt;rng:except&gt;</span>
    <span class="element">&lt;rng:nsName <span class="attribute">ns</span>="<span class="attributevalue">http://www.tei-c.org/ns/1.0</span>"/&gt;</span>
    <span class="element">&lt;rng:name <span class="attribute">ns</span>="<span class="attributevalue">http://www.tei-c.org/ns/Examples</span>"&gt;</span>egXML<span class="element">&lt;/rng:name&gt;</span>
   <span class="element">&lt;/rng:except&gt;</span>
  <span class="element">&lt;/rng:anyName&gt;</span>
  <span class="element">&lt;rng:zeroOrMore&gt;</span>
   <span class="element">&lt;rng:attribute&gt;</span>
    <span class="element">&lt;rng:anyName/&gt;</span>
   <span class="element">&lt;/rng:attribute&gt;</span>
  <span class="element">&lt;/rng:zeroOrMore&gt;</span>
  <span class="element">&lt;rng:zeroOrMore&gt;</span>
   <span class="element">&lt;rng:choice&gt;</span>
    <span class="element">&lt;rng:text/&gt;</span>
    <span class="element">&lt;rng:ref <span class="attribute">name</span>="<span class="attributevalue">macro.anyXML</span>"/&gt;</span>
   <span class="element">&lt;/rng:choice&gt;</span>
  <span class="element">&lt;/rng:zeroOrMore&gt;</span>
 <span class="element">&lt;/rng:element&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td><td><div id="index.xml-egXML-d30e246" class="pre egXML_valid"><span class="element">&lt;content&gt;</span>
 <span class="element">&lt;sequence&gt;</span>
  <span class="element">&lt;elementRef <span class="attribute">key</span>="<span class="attributevalue">anyElement</span>"
   <span class="attribute">except</span>="<span class="attributevalue">http://www.tei-c.org/ns/1.0</span>"/&gt;</span>
  <span class="element">&lt;alternate <span class="attribute">minOccurs</span>="<span class="attributevalue">0</span>"
   <span class="attribute">maxOccurs</span>="<span class="attributevalue">undefined</span>"&gt;</span>
   <span class="element">&lt;textNode/&gt;</span>
   <span class="element">&lt;elementRef <span class="attribute">key</span>="<span class="attributevalue">anyElement</span>"
    <span class="attribute">except</span>="<span class="attributevalue">http://www.tei-c.org/ns/1.0</span>"/&gt;</span>
  <span class="element">&lt;/alternate&gt;</span>
 <span class="element">&lt;/sequence&gt;</span>
<span class="element">&lt;/content&gt;</span></div></td></tr><tr><td colspan="2"><p>The part of the original definition precluding a self-nesting<span class="gi">&lt;teix:egXML&gt;</span> has to be implemented with a schematron <span class="gi">&lt;constraint&gt;</span> if we want to include it.</p></td></tr></table></div></div><div class="teidiv0" id="index.xml-body.1_div.7"><h2><span class="headingNumber">7. </span><span class="head">Exemplars</span></h2><p>As noted above, three of the supplied TEI exemplars redefine <span class="ident">macro.anyXML</span>. In each case, the redefinition is needed to exclude elements from specific namespaces. In <span class="ident">teiAllPlus</span>, the <span class="gi">&lt;elementRef&gt;</span> needs to be <code>&lt;elementRef key="anyElement" except="http://www.tei-c.org/ns/1.0 http://www.w3.org/1998/Math/MathML http://www.w3.org/2000/svg"/&gt; </code>. Similarly, in <span class="ident">tei_math</span>, the exclusion list needs to include <code>http://www.w3.org/1998/Math/MathML</code> and in <span class="ident">tei_svg</span>, <code>http://www.w3.org/2000/svg</code></p></div><!--TEI back--><div class="stdfooter autogenerated"><div class="footer"><!--standard links to project, institution etc--><a class="plain" href="/">Home</a> </div><address>Lou Burnard.
	    Date: 2016-09-09<br /><!--
	  Generated from index.xml using XSLT stylesheets version 7.42.0

	       based on http://www.tei-c.org/Stylesheets/
	       on 2016-09-09T11:09:33Z.
	       SAXON HE 9.5.1.5.
		 --></address></div></body></html>